#!/bin/bash

CHEATSHEETS="${HOME}/.cheat/"
[ ! -d "${CHEATSHEETS}" ] && mkdir -p "${CHEATSHEETS}"
COLOR=true

__print()
{
	local cheatsheet=$1
	[ ! -f "${cheatsheet}" ] && echo "Unknown cheatsheet $(basename "${cheatsheet}")"

	if [ $COLOR ]; then
		vimcat -c "set bg=light|set ft=sh" "${cheatsheet}"
	else
		cat "${cheatsheet}"
	fi
	echo
}

case $1 in
	-l|--list) ls -c "${CHEATSHEETS}" ;;
	-e|--edit) ${EDITOR} "${CHEATSHEETS}/${2}" ;;
	-a|--add)  ${EDITOR} "${CHEATSHEETS}/${2}" ;;
	-h|--help)
		echo "Usage: "
		echo "    cheat -a | --add .......... Add new cheatsheet"
		echo "    cheat -e | --edit ......... Edit existing cheatsheet"
		echo "    cheat -l | --list ......... List cheatsheets"
		echo "    cheat -h | --help ......... Show this message"
		echo
		;;
	*) __print "${CHEATSHEETS}/${1}" ;;
esac
